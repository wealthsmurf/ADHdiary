<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ADHDIARY</title>
    <style>
        :root {
            --bg-color: #F2F2F2;
            --card-bg: #FFFFFF;
            --text-main: #444444;
            --text-sub: #BBBBBB;
            --border-color: #EEEEEE;
            --adhd-blue: #4A90E2;
        }

        body.dark-mode {
            --bg-color: #121212;
            --card-bg: #1E1E1E;
            --text-main: #FFFFFF;
            --text-sub: #888888;
            --border-color: #333333;
        }

        body { 
            margin: 0; padding: 0; font-family: 'Apple SD Gothic Neo', sans-serif;
            background-color: var(--bg-color); display: flex; flex-direction: column;
            align-items: center; height: 100vh; overflow: hidden;
            color: var(--text-main); transition: background-color 0.3s, color 0.3s;
        }

        .dark-toggle {
            position: fixed; top: 20px; right: 20px; width: 45px; height: 45px;
            background: var(--card-bg); border-radius: 50%; display: flex;
            align-items: center; justify-content: center; cursor: pointer;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1); z-index: 3000; font-size: 20px;
        }

        .logo { margin-top: 40px; font-size: 36px; font-weight: 900; letter-spacing: 5px; text-align: center; flex-shrink: 0; }
        .logo span:nth-child(1), .logo span:nth-child(2) { color: #E88385; }
        .logo span:nth-child(3), .logo span:nth-child(4) { color: #F9B252; }
        .logo span:nth-child(5), .logo span:nth-child(6) { color: #82C471; }
        .logo span:nth-child(7), .logo span:nth-child(8) { color: #5B9DED; }

        .main-card {
            background: var(--card-bg); width: 90%; max-width: 380px; margin-top: 30px;
            border-radius: 30px; box-shadow: 0 10px 30px rgba(0,0,0,0.05);
            display: flex; flex-direction: column; align-items: center; 
            flex: 1; min-height: 0; margin-bottom: 80px; transition: background 0.3s;
            padding: 0 20px; box-sizing: border-box;
        }

        .grid-container {
            display: grid; grid-template-columns: 1fr 1fr; flex-shrink: 0;
            gap: 12px; width: 100%; margin-top: 25px; position: relative; min-height: 140px;
        }

        .category-btn {
            height: 60px; border-radius: 12px; border: none;
            color: white; font-size: 16px; font-weight: bold;
            display: flex; align-items: center; justify-content: flex-start;
            padding: 0 15px; cursor: pointer; box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .category-btn .icon { font-size: 24px; margin-right: 10px; }
        .btn-book { background-color: #82C471; }
        .btn-diet { background-color: #F9B252; }
        .btn-daily { background-color: #5B9DED; }
        .btn-food { background-color: #EF6C85; }

        .adhd-mode-btn {
            flex-shrink: 0; width: 180px; height: 70px; background-color: var(--adhd-blue);
            color: white; border-radius: 35px; border: none;
            font-size: 20px; font-weight: 900; margin-top: 20px;
            box-shadow: 0 6px 0 #357ABD; cursor: pointer; z-index: 2000;
        }

        .record-section { 
            width: 100%; margin-top: 30px; text-align: left; 
            display: flex; flex-direction: column; flex: 1; min-height: 0; padding-bottom: 20px;
        }
        .record-section h3 { font-size: 12px; color: var(--text-sub); letter-spacing: 1px; margin-bottom: 10px; flex-shrink: 0; }
        
        .record-scroll-area { overflow-y: auto; flex: 1; padding-right: 5px; }
        .record-scroll-area::-webkit-scrollbar { width: 4px; }
        .record-scroll-area::-webkit-scrollbar-thumb { background: var(--border-color); border-radius: 10px; }

        /* --- Î†àÏΩîÎìú Ïπ¥Îìú Î∞è ÎÇ¥Ïö© Ïπ∏ ÏàòÏ†ï --- */
        .record-card {
            background: var(--bg-color); border-radius: 20px; padding: 18px;
            margin-bottom: 20px; display: flex; flex-direction: column;
            position: relative; box-shadow: inset 0 2px 4px rgba(0,0,0,0.02);
        }
        .record-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 12px; }
        .record-info b { font-size: 16px; color: var(--text-main); display: block; }
        .record-info p { font-size: 12px; color: var(--text-sub); margin: 3px 0 0 0; }

        /* ÎÇ¥Ïö© ÌôïÏù∏ Ïπ∏ (ÌÅ¨Í∏∞ ÎåÄÌè≠ ÌôïÏû•) */
        .record-content { 
            font-size: 14px; color: var(--text-main); line-height: 1.6;
            background: var(--card-bg); padding: 15px; border-radius: 15px;
            white-space: pre-wrap; word-break: break-all;
            min-height: 80px; /* ÏµúÏÜå ÎÜíÏù¥ ÌôïÎ≥¥ */
            max-height: 300px; /* ÏµúÎåÄ ÎÜíÏù¥ ÌôïÏû• */
            overflow-y: auto;
            border: 1px solid var(--border-color);
        }

        .direct-del-btn {
            background: none; border: none; color: #ff8a80;
            font-size: 20px; cursor: pointer; padding: 5px;
        }

        .bottom-nav {
            width: 100%; height: 65px; background: var(--card-bg);
            position: fixed; bottom: 0; display: flex;
            justify-content: space-around; align-items: center;
            border-top: 1px solid var(--border-color); font-size: 24px; color: var(--adhd-blue); z-index: 1000;
        }
    </style>
</head>
<body>

    <div class="dark-toggle" onclick="toggleDarkMode()" id="darkBtn">üåô</div>

    <div class="logo">
        <span>A</span><span>D</span><span>H</span><span>D</span><span>I</span><span>A</span><span>R</span><span>Y</span>
    </div>

    <div class="main-card">
        <div class="grid-container" id="boundary">
            <button class="category-btn btn-book" onclick="location.href='/book'">
                <span class="icon">üìñ</span> Ï±Ö Í∏∞Î°ù
            </button>
            <button class="category-btn btn-diet" onclick="location.href='/diet'">
                <span class="icon">‚öñÔ∏è</span> Îã§Ïù¥Ïñ¥Ìä∏
            </button>
            <button class="category-btn btn-daily" onclick="location.href='/daily'">
                <span class="icon">‚òï</span> ÏùºÏÉÅ
            </button>
            <button class="category-btn btn-food" onclick="location.href='/food'">
                <span class="icon">üç¥</span> ÎßõÏßë
            </button>
        </div>

        <button class="adhd-mode-btn" onclick="toggleADHD()">ADHD-MODE</button>

        <div class="record-section">
            <h3>RECENT RECORDS</h3>
            <div class="record-scroll-area">
                {% for record in records %}
                <div class="record-card">
                    <div class="record-header">
                        <div class="record-info">
                            <b>{{ record.title if record.title else record.type.upper() }}</b>
                            <p>{{ record.date }} | {{ record.type.upper() }}</p>
                        </div>
                        <form action="/delete_{{ record.type }}/{{ record.id }}" method="post" style="margin:0;">
                            <button type="submit" class="direct-del-btn" onclick="return confirm('ÏÇ≠Ï†úÌï†ÍπåÏöî?')">üóëÔ∏è</button>
                        </form>
                    </div>
                    
                    <div class="record-content">
                        {% if record.memo %}
                            {{ record.memo }}
                        {% elif record.meal %}
                            {{ record.meal }}
                        {% elif record.emoji %}
                            Ïò§ÎäòÏùò Í∏∞Î∂Ñ: {{ record.emoji }}
                        {% elif record.weight %}
                            Î™∏Î¨¥Í≤å: {{ record.weight }}kg
                        {% else %}
                            <span style="color:var(--text-sub)">ÏÉÅÏÑ∏ ÎÇ¥Ïö©Ïù¥ ÏóÜÏäµÎãàÎã§.</span>
                        {% endif %}
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
    </div>

    <div class="bottom-nav">
        <div onclick="location.href='/'" style="cursor:pointer">üè†</div><div></div><div></div><div></div>
    </div>

    <script>
        // 1. Îã§ÌÅ¨Î™®Îìú
        function toggleDarkMode() {
            const body = document.body;
            body.classList.toggle('dark-mode');
            const isDark = body.classList.contains('dark-mode');
            localStorage.setItem('darkMode', isDark);
            document.getElementById('darkBtn').innerText = isDark ? '‚òÄÔ∏è' : 'üåô';
        }
        if (localStorage.getItem('darkMode') === 'true') {
            document.body.classList.add('dark-mode');
            document.getElementById('darkBtn').innerText = '‚òÄÔ∏è';
        }

        // 2. ADHD Î™®Îìú (ÎÇ†ÏïÑÎã§ÎãàÍ∏∞ Ïú†ÏßÄ)
        let isADHD = false;
        let animationId;
        const buttons = document.querySelectorAll('.category-btn');
        let particles = [];

        function toggleADHD() {
            isADHD = !isADHD;
            if (isADHD) {
                particles = [];
                buttons.forEach((btn) => {
                    const rect = btn.getBoundingClientRect();
                    particles.push({
                        el: btn, x: rect.left, y: rect.top, width: rect.width, height: rect.height,
                        dx: (Math.random() - 0.5) * 15, dy: (Math.random() - 0.5) * 15
                    });
                    btn.style.width = rect.width + 'px';
                    btn.style.height = rect.height + 'px';
                    btn.style.position = 'fixed'; btn.style.left = '0px'; btn.style.top = '0px'; btn.style.zIndex = '1500';
                });
                animate();
            } else { location.reload(); }
        }

        function animate() {
            if (!isADHD) return;
            particles.forEach(p => {
                p.x += p.dx; p.y += p.dy;
                if (p.x <= 0 || p.x + p.width >= window.innerWidth) p.dx *= -1;
                if (p.y <= 0 || p.y + p.height >= window.innerHeight - 65) p.dy *= -1;
                p.el.style.transform = `translate3d(${p.x}px, ${p.y}px, 0)`;
            });
            animationId = requestAnimationFrame(animate);
        }
    </script>
</body>
</html>
